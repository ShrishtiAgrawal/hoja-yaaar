{"ast":null,"code":"import _objectSpread from\"E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{UserContext}from'../../App';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),mypics=_useState2[0],setPics=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];useEffect(function(){fetch('/mypost',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);setPics(result.mypost);});},[]);useEffect(function(){if(image){var data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"localvocal\");data.append(\"cloud_name\",\"cldbase\");fetch(\" https://api.cloudinary.com/v1_1/cldbase/image/upload\",{method:\"post\",body:data}).then(function(res){return res.json();}).then(function(data){fetch('/updatepic',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({pic:data.url})}).then(function(res){return res.json();}).then(function(result){console.log(result);localStorage.setItem(\"user\",JSON.stringify(_objectSpread(_objectSpread({},state),{},{pic:result.pic})));dispatch({type:\"UPDATEPIC\",payload:result.pic});//window.location.reload()\n});}).catch(function(err){console.log(err);});}},[image]);var updatePhoto=function updatePhoto(file){setImage(file);};return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"550px\",margin:\"0px auto\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"18px 0px\",borderBottom:\"1px solid grey\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-around\"},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"160px\",height:\"160px\",borderRadius:\"80px\"},src:state?state.pic:\"loading\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:state?state.name:\"loading\"}),/*#__PURE__*/_jsx(\"h5\",{children:state?state.email:\"loading\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"},children:[/*#__PURE__*/_jsxs(\"h6\",{children:[mypics.length,\" posts\"]}),/*#__PURE__*/_jsxs(\"h6\",{children:[state?state.followers.length:\"0\",\" followers\"]}),/*#__PURE__*/_jsxs(\"h6\",{children:[state?state.following.length:\"0\",\" followings\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-field input-field\",style:{margin:\"10px\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"btn #64b5f6 blue darken-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Update pic\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(e){return updatePhoto(e.target.files[0]);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"file-path-wrapper\",children:/*#__PURE__*/_jsx(\"input\",{className:\"file-path validate\",type:\"text\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:mypics.map(function(item){return/*#__PURE__*/_jsx(\"img\",{className:\"item\",src:item.photo,alt:item.title},item._id);})})]});};export default Profile;","map":{"version":3,"sources":["E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/src/components/screens/Profile.js"],"names":["React","useEffect","useState","useContext","UserContext","Profile","mypics","setPics","state","dispatch","image","setImage","fetch","headers","localStorage","getItem","then","res","json","result","console","log","mypost","data","FormData","append","method","body","JSON","stringify","pic","url","setItem","type","payload","catch","err","updatePhoto","file","maxWidth","margin","borderBottom","display","justifyContent","width","height","borderRadius","name","email","length","followers","following","e","target","files","map","item","photo","title","_id"],"mappings":"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","sourcesContent":["import React,{useEffect,useState,useContext} from 'react'\r\nimport {UserContext} from '../../App'\r\n\r\nconst Profile  = ()=>{\r\n    const [mypics,setPics] = useState([])\r\n    const {state,dispatch} = useContext(UserContext)\r\n    const [image,setImage] = useState(\"\")\r\n    useEffect(()=>{\r\n       fetch('/mypost',{\r\n           headers:{\r\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n           }\r\n       }).then(res=>res.json())\r\n       .then(result=>{\r\n           console.log(result)\r\n           setPics(result.mypost)\r\n       })\r\n    },[])\r\n    useEffect(()=>{\r\n       if(image){\r\n        const data = new FormData()\r\n        data.append(\"file\",image)\r\n        data.append(\"upload_preset\",\"localvocal\")\r\n        data.append(\"cloud_name\",\"cldbase\")\r\n        fetch(\" https://api.cloudinary.com/v1_1/cldbase/image/upload\",{\r\n            method:\"post\",\r\n            body:data\r\n        })\r\n        .then(res=>res.json())\r\n        .then(data=>{\r\n    \r\n       \r\n           fetch('/updatepic',{\r\n               method:\"put\",\r\n               headers:{\r\n                   \"Content-Type\":\"application/json\",\r\n                   \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n               },\r\n               body:JSON.stringify({\r\n                   pic:data.url\r\n               })\r\n           }).then(res=>res.json())\r\n           .then(result=>{\r\n               console.log(result)\r\n               localStorage.setItem(\"user\",JSON.stringify({...state,pic:result.pic}))\r\n               dispatch({type:\"UPDATEPIC\",payload:result.pic})\r\n               //window.location.reload()\r\n           })\r\n       \r\n        })\r\n        .catch(err=>{\r\n            console.log(err)\r\n        })\r\n       }\r\n    },[image])\r\n    const updatePhoto = (file)=>{\r\n        setImage(file)\r\n    }\r\n   return (\r\n       <div style={{maxWidth:\"550px\",margin:\"0px auto\"}}>\r\n           <div style={{\r\n              margin:\"18px 0px\",\r\n               borderBottom:\"1px solid grey\"\r\n           }}>\r\n\r\n         \r\n           <div style={{\r\n               display:\"flex\",\r\n               justifyContent:\"space-around\",\r\n              \r\n           }}>\r\n               <div>\r\n                   <img style={{width:\"160px\",height:\"160px\",borderRadius:\"80px\"}}\r\n                   src={state?state.pic:\"loading\"}\r\n                   />\r\n                 \r\n               </div>\r\n               <div>\r\n                   <h4>{state?state.name:\"loading\"}</h4>\r\n                   <h5>{state?state.email:\"loading\"}</h5>\r\n                   <div style={{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}}>\r\n                       <h6>{mypics.length} posts</h6>\r\n                       <h6>{state?state.followers.length:\"0\"} followers</h6>\r\n                       <h6>{state?state.following.length:\"0\"} followings</h6>\r\n                   </div>\r\n\r\n               </div>\r\n           </div>\r\n        \r\n            <div className=\"file-field input-field\" style={{margin:\"10px\"}}>\r\n            <div className=\"btn #64b5f6 blue darken-1\">\r\n                <span>Update pic</span>\r\n                <input type=\"file\" onChange={(e)=>updatePhoto(e.target.files[0])} />\r\n            </div>\r\n            <div className=\"file-path-wrapper\">\r\n                <input className=\"file-path validate\" type=\"text\" />\r\n            </div>\r\n            </div>\r\n            </div>      \r\n           <div className=\"gallery\">\r\n               {\r\n                   mypics.map(item=>{\r\n                       return(\r\n                        <img key={item._id} className=\"item\" src={item.photo} alt={item.title}/>  \r\n                       )\r\n                   })\r\n               }\r\n\r\n           \r\n           </div>\r\n       </div>\r\n   )\r\n}\r\n\r\n\r\nexport default Profile"]},"metadata":{},"sourceType":"module"}