{"ast":null,"code":"import _toConsumableArray from\"E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{UserContext}from'../../App';import{useParams}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Profile=function Profile(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userProfile=_useState2[0],setProfile=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;var _useParams=useParams(),userid=_useParams.userid;var _useState3=useState(state?!state.following.includes(userid):true),_useState4=_slicedToArray(_useState3,2),showfollow=_useState4[0],setShowFollow=_useState4[1];useEffect(function(){fetch(\"/user/\".concat(userid),{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){//console.log(result)\nsetProfile(result);});},[]);var followUser=function followUser(){fetch('/follow',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem('jwt')},body:JSON.stringify({followId:userid})}).then(function(res){return res.json();}).then(function(data){dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}});localStorage.setItem(\"user\",JSON.stringify(data));setProfile(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{user:_objectSpread(_objectSpread({},prevState.user),{},{followers:[].concat(_toConsumableArray(prevState.user.followers),[data._id])})});});setShowFollow(false);});};var unfollowUser=function unfollowUser(){fetch('/unfollow',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem('jwt')},body:JSON.stringify({unfollowId:userid})}).then(function(res){return res.json();}).then(function(data){dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}});localStorage.setItem(\"user\",JSON.stringify(data));setProfile(function(prevState){var newFollower=prevState.user.followers.filter(function(item){return item!=data._id;});return _objectSpread(_objectSpread({},prevState),{},{user:_objectSpread(_objectSpread({},prevState.user),{},{followers:newFollower})});});setShowFollow(true);});};return/*#__PURE__*/_jsx(_Fragment,{children:userProfile?/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"550px\",margin:\"0px auto\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-around\",margin:\"18px 0px\",borderBottom:\"1px solid grey\"},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"160px\",height:\"160px\",borderRadius:\"80px\"},src:userProfile.user.pic})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:userProfile.user.name}),/*#__PURE__*/_jsx(\"h5\",{children:userProfile.user.email}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"},children:[/*#__PURE__*/_jsxs(\"h6\",{children:[userProfile.posts.length,\" posts\"]}),/*#__PURE__*/_jsxs(\"h6\",{children:[userProfile.user.followers.length,\" followers\"]}),/*#__PURE__*/_jsxs(\"h6\",{children:[userProfile.user.following.length,\" following\"]})]}),showfollow?/*#__PURE__*/_jsx(\"button\",{style:{margin:\"10px\"},className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:function onClick(){return followUser();},children:\"Follow\"}):/*#__PURE__*/_jsx(\"button\",{style:{margin:\"10px\"},className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:function onClick(){return unfollowUser();},children:\"UnFollow\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:userProfile.posts.map(function(item){return/*#__PURE__*/_jsx(\"img\",{className:\"item\",src:item.photo,alt:item.title},item._id);})})]}):/*#__PURE__*/_jsx(\"h2\",{children:\"loading...!\"})});};export default Profile;","map":{"version":3,"sources":["E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/src/components/screens/UserProfile.js"],"names":["React","useEffect","useState","useContext","UserContext","useParams","Profile","userProfile","setProfile","state","dispatch","userid","following","includes","showfollow","setShowFollow","fetch","headers","localStorage","getItem","then","res","json","result","followUser","method","body","JSON","stringify","followId","data","type","payload","followers","setItem","prevState","user","_id","unfollowUser","unfollowId","newFollower","filter","item","maxWidth","margin","display","justifyContent","borderBottom","width","height","borderRadius","pic","name","email","posts","length","map","photo","title"],"mappings":"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","sourcesContent":["import React,{useEffect,useState,useContext} from 'react'\r\nimport {UserContext} from '../../App'\r\nimport {useParams} from 'react-router-dom'\r\nconst Profile  = ()=>{\r\n    const [userProfile,setProfile] = useState(null)\r\n    \r\n    const {state,dispatch} = useContext(UserContext)\r\n    const {userid} = useParams()\r\n    const [showfollow,setShowFollow] = useState(state?!state.following.includes(userid):true)\r\n    useEffect(()=>{\r\n       fetch(`/user/${userid}`,{\r\n           headers:{\r\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n           }\r\n       }).then(res=>res.json())\r\n       .then(result=>{\r\n           //console.log(result)\r\n         \r\n            setProfile(result)\r\n       })\r\n    },[])\r\n\r\n\r\n    const followUser = ()=>{\r\n        fetch('/follow',{\r\n            method:\"put\",\r\n            headers:{\r\n                \"Content-Type\":\"application/json\",\r\n                \"Authorization\":\"Bearer \"+localStorage.getItem('jwt')\r\n            },\r\n            body:JSON.stringify({\r\n                followId:userid\r\n            })\r\n        }).then(res=>res.json())\r\n        .then(data=>{\r\n        \r\n            dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}})\r\n             localStorage.setItem(\"user\",JSON.stringify(data))\r\n             setProfile((prevState)=>{\r\n                 return {\r\n                     ...prevState,\r\n                     user:{\r\n                         ...prevState.user,\r\n                         followers:[...prevState.user.followers,data._id]\r\n                        }\r\n                 }\r\n             })\r\n             setShowFollow(false)\r\n        })\r\n    }\r\n    const unfollowUser = ()=>{\r\n        fetch('/unfollow',{\r\n            method:\"put\",\r\n            headers:{\r\n                \"Content-Type\":\"application/json\",\r\n                \"Authorization\":\"Bearer \"+localStorage.getItem('jwt')\r\n            },\r\n            body:JSON.stringify({\r\n                unfollowId:userid\r\n            })\r\n        }).then(res=>res.json())\r\n        .then(data=>{\r\n            \r\n            dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}})\r\n             localStorage.setItem(\"user\",JSON.stringify(data))\r\n            \r\n             setProfile((prevState)=>{\r\n                const newFollower = prevState.user.followers.filter(item=>item != data._id )\r\n                 return {\r\n                     ...prevState,\r\n                     user:{\r\n                         ...prevState.user,\r\n                         followers:newFollower\r\n                        }\r\n                 }\r\n             })\r\n             setShowFollow(true)\r\n             \r\n        })\r\n    }\r\n   return (\r\n       <>\r\n       {userProfile ?\r\n       <div style={{maxWidth:\"550px\",margin:\"0px auto\"}}>\r\n           <div style={{\r\n               display:\"flex\",\r\n               justifyContent:\"space-around\",\r\n               margin:\"18px 0px\",\r\n               borderBottom:\"1px solid grey\"\r\n           }}>\r\n               <div>\r\n                   <img style={{width:\"160px\",height:\"160px\",borderRadius:\"80px\"}}\r\n                   src={userProfile.user.pic}\r\n                   />\r\n               </div>\r\n               <div>\r\n                   <h4>{userProfile.user.name}</h4>\r\n                   <h5>{userProfile.user.email}</h5>\r\n                   <div style={{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}}>\r\n                       <h6>{userProfile.posts.length} posts</h6>\r\n                       <h6>{userProfile.user.followers.length} followers</h6>\r\n                       <h6>{userProfile.user.following.length} following</h6>\r\n                   </div>\r\n                   {showfollow?\r\n                   <button style={{\r\n                       margin:\"10px\"\r\n                   }} className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\r\n                    onClick={()=>followUser()}\r\n                    >\r\n                        Follow\r\n                    </button>\r\n                    : \r\n                    <button\r\n                    style={{\r\n                        margin:\"10px\"\r\n                    }}\r\n                    className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\r\n                    onClick={()=>unfollowUser()}\r\n                    >\r\n                        UnFollow\r\n                    </button>\r\n                    }\r\n                   \r\n                  \r\n\r\n               </div>\r\n           </div>\r\n     \r\n           <div className=\"gallery\">\r\n               {\r\n                   userProfile.posts.map(item=>{\r\n                       return(\r\n                        <img key={item._id} className=\"item\" src={item.photo} alt={item.title}/>  \r\n                       )\r\n                   })\r\n               }\r\n\r\n           \r\n           </div>\r\n       </div>\r\n       \r\n       \r\n       : <h2>loading...!</h2>}\r\n       \r\n       </>\r\n   )\r\n}\r\n\r\n\r\nexport default Profile"]},"metadata":{},"sourceType":"module"}